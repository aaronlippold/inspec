---
title: About the etc_hosts Resource
---

# etc_hosts

Use the `etc_hosts` InSpec audit resource to test rules set to match IP address's with hostnames.
## Syntax

An etc/hosts rule specifies an IP address and what it's hostname is along with an aliase names it can have.

## Syntax

Use the where clause to match a property to one or more rules in the hosts file.

    describe etc_hosts.where { ip_address == 'value' } do
      its ( 'canonical_hostname' ) { should eq ['hostname'] }
      its ( 'aliases_list' ) { should eq [['list']] }
    end

Use the optional constructor parameter to give an alternative path to hosts file

    describe etc_hosts.where { ip_address == 'value' } do
      its ( 'canonical_hostname' ) { should eq ['hostname'] }
      its ( 'aliases_list' ) { should eq [['list']] }
    end

where

* `ip_address` is the ip address of the hostname in either ipv4 or ipv6 format.
* `canonical_hostname` is the name associated with the ip address.
* `aliases_list` is an optional list of other names that can be associated with the ip and host name.

## Supported Properties

    'ip_address', 'canonical_hostname', 'aliases_list'

## Property Examples and Return Types

### ip_address(String)

`ip_address` returns an array of strings that matches the where condition of the filter table.

    describe etc_hosts.where { canonical_hostname == 'localhost' } do
      its ( 'ip_address' ) { should eq ['127.0.1.154'] }
    end

### canonical_hostname(String)

`canonical_hostname` returns an array of strings that matches the where condition of the filter table.

    describe etc_hosts.where { ip_address == '::1' } do
      its('canonical_hostname') { should eq ['localhost'] }
    end

### aliases_list([String])

`aliases_list` returns a two dimensional array of strings that matches the where condition of the filter table.

    describe etc_hosts.where { ip_address == '127.0.1.154' } do
      its('canonical_hostname') { should eq [['localhost.localdomain', 'localhost4', 'localhost4.localdomain4'],  ['localhost.localdomain', 'localhost6', 'localhost6.localdomain6']] }
    end
